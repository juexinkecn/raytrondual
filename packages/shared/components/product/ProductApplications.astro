---
import Card from '../ui/Card.astro';
import Badge from '../ui/Badge.astro';
import type { Translations } from '../../types';

interface Application {
  industry: string;
  industryZh: string;
  icon: string;
  useCases: Array<{
    title: string;
    titleZh: string;
    description: string;
    descriptionZh: string;
  }>;
  benefits: Array<{
    benefit: string;
    benefitZh: string;
  }>;
  technicalAdvantages: Array<{
    advantage: string;
    advantageZh: string;
  }>;
}

interface Props {
  lang: 'en' | 'zh';
  applications: Application[];
  caseStudy?: {
    title: string;
    titleZh: string;
    company: string;
    challenge: string;
    challengeZh: string;
    solution: string;
    solutionZh: string;
    results: Array<{ metric: string; metricZh: string; value: string }>;
  };
}

const { lang, applications, caseStudy } = Astro.props;

const t: Translations = {
  en: {
    sectionTitle: 'Applications & Use Cases',
    sectionSubtitle: 'Discover How This Product Powers Innovation',
    useCases: 'Common Use Cases',
    benefits: 'Key Benefits',
    technicalAdvantages: 'Technical Advantages',
    caseStudyTitle: 'Success Story',
    challenge: 'Challenge',
    solution: 'Solution',
    results: 'Results',
    exploreMore: 'Explore More Applications'
  },
  zh: {
    sectionTitle: '应用与案例',
    sectionSubtitle: '探索该产品如何推动创新',
    useCases: '常见应用',
    benefits: '主要优势',
    technicalAdvantages: '技术优势',
    caseStudyTitle: '成功案例',
    challenge: '挑战',
    solution: '解决方案',
    results: '成果',
    exploreMore: '探索更多应用'
  }
};

const content = t[lang];

// Industry icon paths
const iconPaths: Record<string, string> = {
  solar: 'M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z',
  battery: 'M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z',
  automotive: 'M8 17a2 2 0 100-4 2 2 0 000 4zm0 0h8m-8 0a2 2 0 11-4 0m12 0a2 2 0 100-4 2 2 0 000 4zm0 0a2 2 0 110-4M3 17h2a2 2 0 012-2h2m14 0a2 2 0 00-2-2h-2M5 8a2 2 0 012-2h10a2 2 0 012 2v7H5V8z',
  electronics: 'M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z',
  aerospace: 'M12 19l9 2-9-18-9 18 9-2zm0 0v-8',
  medical: 'M12 4v16m8-8H4',
  industrial: 'M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z',
  cable: 'M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01'
};

// Color schemes for industries
const colorSchemes: Record<string, string> = {
  solar: 'from-yellow-500 to-orange-500',
  battery: 'from-green-500 to-emerald-500',
  automotive: 'from-blue-500 to-blue-600',
  electronics: 'from-purple-500 to-purple-600',
  aerospace: 'from-cyan-500 to-blue-600',
  medical: 'from-red-500 to-pink-500',
  industrial: 'from-orange-500 to-red-500',
  cable: 'from-gray-600 to-gray-700'
};
---

<section class="py-16 bg-gray-50">
  <div class="container mx-auto px-4">
    <!-- Section Header -->
    <div class="text-center mb-12">
      <h2 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
        {content.sectionTitle}
      </h2>
      <p class="text-xl text-gray-600">
        {content.sectionSubtitle}
      </p>
    </div>

    <!-- Applications Grid -->
    <div class="space-y-8 mb-16">
      {applications.map((app, index) => {
        const gradientClass = colorSchemes[app.icon] || colorSchemes.industrial;
        
        return (
          <Card variant="default" class="overflow-hidden hover:shadow-2xl transition-shadow">
            <div class="grid lg:grid-cols-3 gap-8 p-8">
              <!-- Left: Industry Info -->
              <div class="lg:col-span-1">
                <div class={`w-16 h-16 mb-4 bg-gradient-to-br ${gradientClass} rounded-2xl flex items-center justify-center shadow-lg`}>
                  <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d={iconPaths[app.icon] || iconPaths.industrial}/>
                  </svg>
                </div>
                
                <h3 class="text-2xl font-bold text-gray-900 mb-4">
                  {lang === 'en' ? app.industry : app.industryZh}
                </h3>

                <!-- Benefits -->
                <div class="mb-6">
                  <h4 class="text-sm font-bold text-gray-700 uppercase mb-3">{content.benefits}</h4>
                  <div class="space-y-2">
                    {app.benefits.map(benefit => (
                      <div class="flex items-start">
                        <svg class="w-5 h-5 text-green-500 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                        </svg>
                        <span class="text-sm text-gray-700">
                          {lang === 'en' ? benefit.benefit : benefit.benefitZh}
                        </span>
                      </div>
                    ))}
                  </div>
                </div>

                <!-- Technical Advantages -->
                <div>
                  <h4 class="text-sm font-bold text-gray-700 uppercase mb-3">{content.technicalAdvantages}</h4>
                  <div class="flex flex-wrap gap-2">
                    {app.technicalAdvantages.map(advantage => (
                      <Badge variant="info" class="text-xs">
                        {lang === 'en' ? advantage.advantage : advantage.advantageZh}
                      </Badge>
                    ))}
                  </div>
                </div>
              </div>

              <!-- Right: Use Cases -->
              <div class="lg:col-span-2">
                <h4 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
                  <svg class="w-6 h-6 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
                  </svg>
                  {content.useCases}
                </h4>

                <div class="grid md:grid-cols-2 gap-4">
                  {app.useCases.map(useCase => (
                    <div class="bg-white rounded-xl p-5 border border-gray-200 hover:border-blue-300 hover:shadow-md transition-all">
                      <h5 class="font-bold text-gray-900 mb-2">
                        {lang === 'en' ? useCase.title : useCase.titleZh}
                      </h5>
                      <p class="text-sm text-gray-600">
                        {lang === 'en' ? useCase.description : useCase.descriptionZh}
                      </p>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          </Card>
        );
      })}
    </div>

    <!-- Case Study (if provided) -->
    {caseStudy && (
      <div class="mb-12">
        <Card variant="default" class="overflow-hidden">
          <div class="bg-gradient-to-r from-blue-600 to-blue-700 p-8 text-white">
            <h3 class="text-3xl font-bold mb-2">{content.caseStudyTitle}</h3>
            <p class="text-xl text-blue-100">
              {lang === 'en' ? caseStudy.title : caseStudy.titleZh}
            </p>
            <Badge variant="warning" class="mt-4 text-sm font-bold">
              {caseStudy.company}
            </Badge>
          </div>

          <div class="p-8">
            <div class="grid md:grid-cols-2 gap-8 mb-8">
              <!-- Challenge -->
              <div>
                <h4 class="text-xl font-bold text-gray-900 mb-4 flex items-center">
                  <svg class="w-6 h-6 text-red-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                  </svg>
                  {content.challenge}
                </h4>
                <p class="text-gray-700 leading-relaxed">
                  {lang === 'en' ? caseStudy.challenge : caseStudy.challengeZh}
                </p>
              </div>

              <!-- Solution -->
              <div>
                <h4 class="text-xl font-bold text-gray-900 mb-4 flex items-center">
                  <svg class="w-6 h-6 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                  {content.solution}
                </h4>
                <p class="text-gray-700 leading-relaxed">
                  {lang === 'en' ? caseStudy.solution : caseStudy.solutionZh}
                </p>
              </div>
            </div>

            <!-- Results -->
            <div>
              <h4 class="text-xl font-bold text-gray-900 mb-4 flex items-center">
                <svg class="w-6 h-6 text-blue-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                </svg>
                {content.results}
              </h4>

              <div class="grid md:grid-cols-3 gap-6">
                {caseStudy.results.map(result => (
                  <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-6 text-center">
                    <div class="text-4xl font-bold text-blue-600 mb-2">{result.value}</div>
                    <div class="text-sm text-gray-700">
                      {lang === 'en' ? result.metric : result.metricZh}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </Card>
      </div>
    )}

    <!-- CTA -->
    <div class="text-center">
      <a 
        href={lang === 'en' ? '/en/applications' : '/zh/applications'}
        class="inline-flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-300 shadow-lg hover:shadow-xl font-semibold"
      >
        {content.exploreMore}
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
        </svg>
      </a>
    </div>
  </div>
</section>
